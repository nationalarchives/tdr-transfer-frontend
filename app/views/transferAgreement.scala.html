@* helper package contains inputRadioGroup therefore exclude from imports to prevent ambiguous import with view of the same name *@
@import helper.{inputRadioGroup => _, _}
@import viewsapi.FormFunctions._
@import java.util.UUID

@import scala.language.postfixOps
@(consignmentId: UUID, transferAgreementForm: Form[TransferAgreementData], agreementOptions: Seq[(String, String)], isAlreadyCompleted: Boolean)(implicit request: RequestHeader, messages: Messages)
@shouldOptionBeSelected(option: String) = @{
  if(!isAlreadyCompleted) transferAgreementForm.data.getOrElse(option, "") else "true"
}
@main("Transfer agreement") {
@defining(play.core.PlayVersion.current) { version =>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        @progressIndicator(Messages("transferAgreement.progress"))

        <h1 class="govuk-heading-l">Transfer agreement</h1>
        <p class="govuk-body">You must confirm all statements before proceeding. If you cannot, please close your browser and contact your transfer advisor.</p>
        <div class="govuk-warning-text">
            <span class="govuk-warning-text__icon" aria-hidden="true">!</span> <!-- "aria-hidden" was added by GDS to prevent screen reader from saying "exclamation mark"-->
            <strong class="govuk-warning-text__text">
              <span class="govuk-warning-text__assistive">Warning</span>
                This service is in private beta. During this time, the Transfer Digital Records service can only accept records that are in English, are Public Records and are Crown Copyright. For more information, please see our <a href="@routes.FaqController.faq()#other-languages" target="_blank" rel="noopener noreferrer" class="govuk-link">FAQ (opens in new tab)</a> if you need to transfer records that this service cannot currently handle.
            </strong>
        </div>
        <div id="upload-progress-success" class="success-summary" aria-labelledby="success-summary-title"
        role="alert" data-module="success-summary" tabindex="-1" @if(!isAlreadyCompleted){hidden}>
          <div class="success-summary__body">
            <h2 class="success-summary__title">You have already confirmed all statements</h2>
            <p class="govuk-body">Click 'Continue' to proceed with your transfer.</p>
          </div>
        </div>
        @errorSummary(
            transferAgreementForm("publicRecord"),
            transferAgreementForm("crownCopyright"),
            transferAgreementForm("english"),
            transferAgreementForm("droAppraisalSelection"),
            transferAgreementForm("droSensitivity"),
            transferAgreementForm("openRecords"),
        )
        @form(
            if(!isAlreadyCompleted) {routes.TransferAgreementController.transferAgreementSubmit(consignmentId)}
            else {routes.UploadController.uploadPage(consignmentId)},
            (Symbol("novalidate"), "")
        ) {
        <div class="govuk-form-group">
        @if(!isAlreadyCompleted) @{CSRF.formField} else {}
            @inputSingleCheckbox(
                transferAgreementForm("publicRecord"),
                Symbol("_label") -> "I confirm that the records are Public Records.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("publicRecord"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
            @inputSingleCheckbox(
                transferAgreementForm("crownCopyright"),
                Symbol("_label") -> "I confirm that the records are all Crown Copyright.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("crownCopyright"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
            @inputSingleCheckbox(
                transferAgreementForm("english"),
                Symbol("_label") -> "I confirm that the records are all in English.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("english"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
            <!-- DRO confirmation -->
            @inputSingleCheckbox(
                transferAgreementForm("droAppraisalSelection"),
                Symbol("_label") -> "I confirm that the Departmental Records Officer (DRO) has signed off on the appraisal and selection decision.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("droAppraisalSelection"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
            @inputSingleCheckbox(
                transferAgreementForm("droSensitivity"),
                Symbol("_label") -> "I confirm that the Departmental Records Officer (DRO) has signed off on the sensitivity review.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("droSensitivity"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
            @inputSingleCheckbox(
                transferAgreementForm("openRecords"),
                Symbol("_label") -> "I confirm that all records are open and no Freedom of Information (FOI) exemptions apply to these records.",
                Symbol("_value") -> "true",
                Symbol("_smallCheckbox") -> true,
                Symbol("_checkedOption") -> shouldOptionBeSelected("openRecords"),
                Symbol("_requiredOption") -> true,
                Symbol("_disabledOption") -> isAlreadyCompleted.toString
            )
        </div>
        <!-- Buttons -->
        <div class="govuk-button-group">
            <!-- Continue -->
            <button data-prevent-double-click="true" class="govuk-button" type="submit" data-module="govuk-button" role="button">
                Continue
            </button>

            <!-- Cancel -->
            <a class="govuk-link" href="@routes.DashboardController.dashboard()">Cancel</a>
        </div>
        }
    </div>
</div>
}
}