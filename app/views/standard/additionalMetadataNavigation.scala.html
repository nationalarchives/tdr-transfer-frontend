@import java.util.UUID
@import graphql.codegen.GetFilesForNavigation.getFilesForNavigation.GetConsignment.Files
@import controllers.util.NaturalSorting._
@(consignmentId: UUID, name: String, metadataType: String, files: Map[UUID, List[Files]], parentId: UUID)(implicit messages: Messages, request: RequestHeader)

@display(file: Files) = {
    @if(!files.contains(file.fileId)) {
      @defining(file.fileType.contains("Folder")) { isFolder =>
        <li class="@if(isFolder) {folder-item}">
          <div class="nested-file-container">
            <span class="file-expander" id="expander-@file.fileId">
              @if(isFolder) { + } else { &nbsp;&nbsp;  }
            </span>
            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input" id="@file.fileId" type="checkbox" value="@file.fileId" autocomplete="off">
              <label class="govuk-label govuk-checkboxes__label" for="@file.fileId">
              @if(isFolder) {
                üìÅ @file.fileName.getOrElse("")
              } else {
                üìä @file.fileName.getOrElse("")
              }
              </label>
            </div>
          </div>
        </li>
      }
    } else {
        <li class="@if(file.fileType.contains("Folder")) {folder-item}">
          <div class="nested-file-container">
            <span class="file-expander" id="expander-@file.fileId">+</span>
            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input" id="@file.fileId" type="checkbox" value="@file.fileId" autocomplete="off">
              <label class="govuk-label govuk-checkboxes__label" for="@file.fileId">
                üìÅ @file.fileName.getOrElse("")
              </label>
            </div>
          </div>
        </li>
        <ul class="nested-file-list" id="folder-group-@file.fileId">
            @Html(files(file.fileId).map(display).mkString("\n"))
        </ul>
    }
}

@main("Additional Metadata", name = name) {
    @defining(play.core.PlayVersion.current) { version =>
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds">
                <h1 class="govuk-heading-l">
                    Add or edit closure metadata on file basis
                </h1>
                <ul class="nested-file-list" id="parent-list">
                    @for(node <- files) {
                      @if(node._1 == parentId) {
                        @for(file <- node._2.sortBy(n => natural(n.fileName.getOrElse("")))) {
                          @display(file)
                        }
                      }
                    }
                </ul>
            </div>
        </div>
    }
}
