@import views.html.partials.{notificationBanner, progressIndicator, transferReference, warningMessage}
@import services.Details

@import java.util.UUID
@import views.html.partials.details
@(consignmentRef: String, consignmentId: UUID, name: String, closurePropertiesSummaries: List[String], descriptivePropertiesSummaries: List[String])(implicit messages: Messages, request: RequestHeader)
@main(title = "Descriptive and closure metadata", name = name) {
    @defining(play.core.PlayVersion.current) { version =>
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-two-thirds-from-desktop">
                @progressIndicator(Messages("additionalMetadataStart.progress"))
                <h1 class="govuk-heading-l">Descriptive & closure metadata</h1>

                @notificationBanner(
                    Messages("notification.savedProgress.title"),
                    Messages("notification.savedProgress.heading"),
                    Messages("notification.savedProgress.metadataInfo", routes.ViewTransfersController.viewConsignments(), "View Transfers")
                )
                <p class="govuk-body">You can now add or edit closure and descriptive metadata to your records.</p>

                @displayCard(
                    "Descriptive metadata",
                    "descriptive",
                    "Not entered",
                    "Add descriptive metadata to your files",
                    "You do not need to add descriptive metadata but it can enhance your record.",
                    descriptivePropertiesSummaries
                )
                @displayCard(
                    "Closure metadata",
                    "closure",
                    "Not entered",
                    "Add closure and associated metadata to your files",
                    "You must add closure metadata to closed files and folders.",
                    closurePropertiesSummaries
                )
                @warningMessage(Messages("additionalMetadata.warningMessage"))
                <a href="@routes.DownloadMetadataController.downloadMetadataPage(consignmentId)" role="button" draggable="false" class="govuk-button" data-module="govuk-button">Next</a>
            </div>
            @transferReference(consignmentRef, isJudgmentUser = false)
        </div>
    }
}

@displayCard(name: String, metadataType: String, progress: String, title: String, description: String, properties: List[String]) = {
  <div class="tdr-card tdr-metadata-card">
    <div class="tdr-card__content">
      <h2 class="govuk-heading-s">
        <a class="govuk-link govuk-link--no-visited-state" href="@routes.AdditionalMetadataNavigationController.getAllFiles(consignmentId, metadataType)">@name</a>
      </h2>
      <strong class="tdr-metadata-card__state govuk-tag govuk-tag--grey">
        @progress
      </strong>
      <p class="govuk-body">@title</p>
      <p class="govuk-inset-text govuk-!-margin-top-0">@description</p>
      <details class="govuk-details" data-module="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">What @{name.toLowerCase} you can provide</span>
        </summary>
        <div class="govuk-details__text">
          <ul class="govuk-list govuk-list--bullet govuk-list--spaced">
            @for(property <- properties.filter(_.nonEmpty)) {
              <li>@property</li>
            }
          </ul>
        </div>
      </details>
      @if(name.toLowerCase == "descriptive metadata") {
        @details(Details("Records with sensitive descriptions", Messages("additionalMetadata.descriptive.sensitive")))
      }
    </div>
  </div>
}
